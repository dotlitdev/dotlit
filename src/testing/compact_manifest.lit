# Compact Manifest

Reducing the serialised size of a manifest of all files in a `.lit` notebook.

Trying out [compct-prefix-tree](https://github.com/sidvishnoi/compact-prefix-tree)

```js
return (async fn => {
  const {CompactPrefixTree} = await import('https://cdn.skypack.dev/compact-prefix-tree')

  const manifest = await fetch('/manifest.json').then(res => res.json())
  const keys = manifest.nodes.map(n=>n.id)
  const trie = new CompactPrefixTree(keys)

  const before = JSON.stringify(keys)
  const after = JSON.stringify(trie.T)
  // console.log(trie.T)
  return `A ${after.length/before.length*100}% reduction.`
})()
```
```>txt attached=true updated=1621379145503
{ '404.lit': null,
  cli: 
   { '/cli.lit': null,
     'ent/': { 'client.lit': null, 'index.jsx': null, style: [Object] } },
  'divergence_from_markdown.lit': null,
  'execute_code_cells.lit': null,
  'functions.lit': null,
  'index.lit': null,
  meta: 
   { '.lit': null,
     '/github_workflows.lit': null,
     '/s': { 'ettings.lit': null, 'tyling_and_themes.lit': [Object] },
     '/files_and_links.lit': null,
     '/.github/workflows/npm-publish.yaml': null },
  'persist_to_github.lit': null,
  'plugin_system.lit': null,
  re: 
   { 'nderer/': 
      { 'renderer.lit': null,
        viewers: [Object],
        'index.jsx': null,
        'extractPlugins.js': null,
        'transcludeCode.js': null,
        'file.txt': null,
        'difftestA.txt': null },
     pl: { 's.lit': null, '/index.': [Object] },
     'mark.lit': null },
  'scratch_pad.lit': null,
  'throwaway/codevaluebug.lit': null,
  'utils/': 
   { 'index.lit': null,
     fs: { '.lit': null, '-promises-': [Object] },
     'urifragments.lit': null,
     'functions.js': null,
     co: { 'nsole.js': null, 'lors.js': null },
     'safe-encoders.js': null,
     'unist-util-': { 'patch-source.js': null, 'select-position.js': null },
     'git-commit-all.js': null,
     'momento.': { lit: null, js: null } },
  'transfomers.lit': null,
  test: 
   { 'ing/': 
      { 'compact_manifest.lit': null,
        in: [Object],
        'isomorphic_git.lit': null,
        'lightningfs.lit': null,
        lo: [Object],
        'private_files.lit': null,
        'runkit.lit': null,
        se: [Object],
        'web_workers.lit': null,
        'test.txt': null,
        'getserviceworker--sw': null },
     '.js': { '': null, x: null },
     '.ts': null },
  './utils/functions.js': null,
  'litconfig.lit': null,
  'articles/ideas': { '_for.lit': null, '.lit': null },
  '.github/workflows/generate.yaml': null,
  'unified.lit': null,
  ma: { 'nifest.json': null, 'rkdown.lit': null },
  'parser/': 
   { 'parser.lit': null,
     'index.js': null,
     'frontmatter.js': null,
     'sections.js': null,
     'codeblocks.js': null,
     'mdblocks.js': null,
     'links.js': null },
  components: 
   { '/': 
      { 'components.lit': null,
        'Document.jsx': null,
        'Header.jsx': null,
        'App.jsx': null,
        'SelectionContext.jsx': null,
        Cell: [Object],
        'Editor.jsx': null,
        'CodeMeta.jsx': null,
        'base/': [Object],
        'Backlinks.jsx': null },
     '.lit': null },
  '../': 
   { 'scratch_pad.lit#viewers': null,
     'components/components.lit': null,
     '../../../../': 
      { 'meta/settings.lit#plantuml-viewer--repl': null,
        'testing/log/': [Object] },
     'utils/git-commit-all.js': null,
     'serviceworker.js': null },
  viewers: { '.lit': null, '/meta.js': null },
  index: null,
  wiki: { '-links.lit': null, 'links.lit': null },
  file: { 'system/index.lit': null, name: null },
  'dummy/': 
   { 'ðŸ”¥.lit': null,
     'example.svg': null,
     'plain.txt': null,
     'data.csv': null },
  'log/': { 'checkforinput.js': null, 'today.js': null },
  'gitworker.js': null,
  'fsviewer.jsx': null,
  'rk.jsx': null,
  'runkit-repl-endpoint.js': null,
  worker: { '.js': null, '2.js': null } }
A 91.78470254957507% reduction.
```