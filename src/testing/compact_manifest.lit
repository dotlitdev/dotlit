# Compact Manifest

Reducing the serialised size of a manifest of all files in a `.lit` notebook.

Trying out [compct-prefix-tree](https://github.com/sidvishnoi/compact-prefix-tree)

```js
return (async fn => {
  const {CompactPrefixTree} = await import('https://cdn.skypack.dev/compact-prefix-tree')

  const manifest = await fetch('/manifest.json').then(res => res.json())
  const keys = manifest.nodes.map(n=>n.id)
  const trie = new CompactPrefixTree(keys)

  const before = JSON.stringify(keys)
  const after = JSON.stringify(trie.T)
  console.log(trie.T)
  return `A ${after.length/before.length*100}% reduction.`
})()
```
```>txt attached=true updated=1621379115043
{"404.lit":null,"cli":{"/cli.lit":null,"ent/":{"client.lit":null,"index.jsx":null,"style":{".styl":null,"s/":{"c":{"odecell.styl":null,"ell":{".styl":null,"menu.styl":null}},"viewers.styl":null}}}},"divergence_from_markdown.lit":null,"execute_code_cells.lit":null,"functions.lit":null,"index.lit":null,"meta":{".lit":null,"/github_workflows.lit":null,"/s":{"ettings.lit":null,"tyling_and_themes.lit":{"":null,"#viewers":null}},"/files_and_links.lit":null,"/.github/workflows/npm-publish.yaml":null},"persist_to_github.lit":null,"plugin_system.lit":null,"re":{"nderer/":{"renderer.lit":null,"viewers":{".lit":null,"/plantuml.lit":null,"/m":{"eta.js":null,"d/":{"admonitions.lit":null,"index.jsx":null}}},"index.jsx":null,"extractPlugins.js":null,"transcludeCode.js":null,"file.txt":null,"difftestA.txt":null},"pl":{"s.lit":null,"/index.":{"lit":null,"js":null}},"mark.lit":null},"scratch_pad.lit":null,"throwaway/codevaluebug.lit":null,"utils/":{"index.lit":null,"fs":{".lit":null,"-promises-":{"gh-utils.js":null,"utils.js":null}},"urifragments.lit":null,"functions.js":null,"co":{"nsole.js":null,"lors.js":null},"safe-encoders.js":null,"unist-util-":{"patch-source.js":null,"select-position.js":null},"git-commit-all.js":null,"momento.":{"lit":null,"js":null}},"transfomers.lit":null,"test":{"ing/":{"compact_manifest.lit":null,"in":{"dex.lit":null,"put_buffer.lit":null},"isomorphic_git.lit":null,"lightningfs.lit":null,"lo":{"cal_remote_files.lit":null,"g/":{"2021-":{"05-":{"09.lit":null,"11.lit":null,"12.lit":null,"13.lit":null,"15.lit":null,"16.lit":null,"17.lit":null,"18.lit":null},"w2":{"0.lit":null,"1.lit":null}},"day.lit":null,"checkforinput.js":null,"today.js":null}},"private_files.lit":null,"runkit.lit":null,"se":{"lection.lit":null,"rviceworker.lit":null},"web_workers.lit":null,"test.txt":null,"getserviceworker--sw":null},".js":{"":null,"x":null},".ts":null},"./utils/functions.js":null,"litconfig.lit":null,"articles/ideas":{"_for.lit":null,".lit":null},".github/workflows/generate.yaml":null,"unified.lit":null,"ma":{"nifest.json":null,"rkdown.lit":null},"parser/":{"parser.lit":null,"index.js":null,"frontmatter.js":null,"sections.js":null,"codeblocks.js":null,"mdblocks.js":null,"links.js":null},"components":{"/":{"components.lit":null,"Document.jsx":null,"Header.jsx":null,"App.jsx":null,"SelectionContext.jsx":null,"Cell":{".jsx":null,"Menu.jsx":null},"Editor.jsx":null,"CodeMeta.jsx":null,"base/":{"Codeblock.jsx":null,"Link.jsx":null},"Backlinks.jsx":null},".lit":null},"../":{"scratch_pad.lit#viewers":null,"components/components.lit":null,"../../../../":{"meta/settings.lit#plantuml-viewer--repl":null,"testing/log/":{"2021":{"":null,".lit":null},"2021-":{"05":{"-12.lit":null,".lit":null},"w20":null,"w2":{"1":{"":null,".lit":null},"0.lit":null}},"year.lit":null}},"utils/git-commit-all.js":null,"serviceworker.js":null},"viewers":{".lit":null,"/meta.js":null},"index":null,"wiki":{"-links.lit":null,"links.lit":null},"file":{"system/index.lit":null,"name":null},"dummy/":{"ðŸ”¥.lit":null,"example.svg":null,"plain.txt":null,"data.csv":null},"log/":{"checkforinput.js":null,"today.js":null},"gitworker.js":null,"fsviewer.jsx":null,"rk.jsx":null,"runkit-repl-endpoint.js":null,"worker":{".js":null,"2.js":null}}
A 91.78470254957507% reduction.
```