<html data-reactroot=""><head><title>execute_code_cells</title><meta name="litsrc" value="execute_code_cells.lit"/><meta name="litroot" value="/"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/><link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/railscasts.css"/><link rel="stylesheet" href="/style.css"/></head><body><div id="lit-app"><div id="header"><menu class="horizontal open has-children"><li class="MenuTitle"><a href="/">Home</a></li><li class="MenuItems"><menu class="has-children"><li class="MenuTitle">File</li></menu><menu class="has-children" disabled=""><li class="MenuTitle">Cell</li></menu><menu class="has-children" disabled=""><li class="MenuTitle">Section</li></menu><menu class="has-children"><li class="MenuTitle">Help</li></menu><menu class="has-children right"><li class="MenuTitle"><span class="led led-grey"></span></li></menu></li></menu></div><div id="content"><section depth="1" class="" startpos="1:1-0" endpos="3:21-46"><cell startpos="1:1-0" endpos="1:25-24"><h1 id="executing-code-cells">Executing <code>code</code> cells</h1></cell><section depth="2" class="" startpos="3:1-26" endpos="3:21-46"><cell startpos="3:1-26" endpos="3:21-46"><h2 id="table-of-contents">Table of Contents</h2><ul>
<li>
<p><a href="#bugs--and-to-do-">Bugs ๐ and To do โ<span class="linkIcon">ยง</span></a></p>
</li>
<li>
<p><a href="#examples">Examples<span class="linkIcon">ยง</span></a></p>
<ul>
<li><a href="#typescript">TypeScript<span class="linkIcon">ยง</span></a></li>
<li><a href="#async-and-promises">Async and Promises<span class="linkIcon">ยง</span></a></li>
<li><a href="#react-jsx">React <code>jsx</code><span class="linkIcon">ยง</span></a></li>
<li><a href="#output-markdown">Output Markdown<span class="linkIcon">ยง</span></a></li>
<li><a href="#meta-lit-global-and-ast">Meta: <code>lit</code> global and AST<span class="linkIcon">ยง</span></a></li>
</ul>
</li>
<li>
<p><a href="#what-if">What if...<span class="linkIcon">ยง</span></a></p>
<ul>
<li><a href="#first-pass">First pass<span class="linkIcon">ยง</span></a></li>
<li><a href="#version-2">Version 2<span class="linkIcon">ยง</span></a></li>
</ul>
</li>
</ul></cell></section></section>
<section depth="2" class="" startpos="5:2-49" endpos="10:47-238"><cell startpos="5:2-49" endpos="10:47-238"><h2 id="bugs--and-to-do-">Bugs ๐ and To do โ</h2><ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->executed cell gets replaced with its output</li>
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->more robust outputs<!-- -->
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->replace &quot;connected&quot; output on exec</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Extract transpilation as <a href="transfomers.html?file=transfomers.lit" title="Transfomers" wikilink="true">Transfomers</a></li>
</ul></cell></section>
<section depth="2" class="" startpos="12:1-240" endpos="45:4-648"><cell startpos="12:1-240" endpos="12:12-251"><h2 id="examples">Examples</h2></cell><cell startpos="18:1-257" endpos="24:4-375" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><ul class="attributes"></ul></span><pre><code class="js">console.log(document.referrer)
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">21.9 hours ago</span></span></span><output><pre><code class="txt">https://dotlit.org/
undefined
</code></pre></output></codecell></cell><section depth="3" class="" startpos="31:1-382" endpos="45:4-648"><cell startpos="31:1-382" endpos="31:15-396"><h3 id="typescript">TypeScript</h3></cell><cell startpos="33:1-398" endpos="45:4-648" class="code"><codecell class="lang-ts local"><span class="meta"><span class="lang">ts</span><span class="repl">js</span><span class="filename">test.ts</span><ul class="attributes"></ul></span><pre><code class="ts">type Options = {[key: number]: string}
const fn = (opts : Options) =&gt; {
  const str:string = 12 
  // need linting to make this useful
  return str
}

return fn()
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.0 days ago</span></span></span><output><pre><code class="txt">12
</code></pre></output></codecell></cell></section></section>
<section depth="3" class="" startpos="53:1-656" endpos="68:4-945"><cell startpos="53:1-656" endpos="53:23-678"><h3 id="async-and-promises">Async and Promises</h3></cell><cell startpos="55:1-680" endpos="68:4-945" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="filename">test.js</span><ul class="attributes"></ul></span><pre><code class="js">const wait = (ms) =&gt; {
  return new Promise(resolve =&gt; {
    setTimeout( () =&gt; {
      resolve(new Date())
    }, ms)
     
  })
}
return wait(1000)
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.5 days ago</span></span></span><output><pre><code class="txt">Thu Apr 22 2021 00:44:01 GMT+0100 (BST)
</code></pre></output></codecell></cell></section>
<section depth="3" class="" startpos="78:1-955" endpos="168:4-3067"><cell startpos="78:1-955" endpos="78:16-970"><h3 id="react-jsx">React <code>jsx</code></h3></cell><cell startpos="80:1-972" endpos="91:4-1199" class="code"><codecell class="lang-jsx local"><span class="meta"><span class="lang">jsx</span><span class="repl">js</span><span class="filename">test.jsx</span><ul class="attributes"></ul></span><pre><code class="jsx">import React from &#x27;https://cdn.skypack.dev/react&#x27;

const Component = props =&gt; {
  return &lt;div&gt;&lt;/div&gt;
}

return &lt;Component/&gt;
</code></pre></codecell><codecell class="dir-error lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="directives"><li style="color:white;background-color:#5c4d28"><span class="directive dir-error">error</span></li></ul><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.0 days ago</span></span></span><output><pre><code class="txt">undefined
</code></pre></output></codecell></cell><cell startpos="93:1-1201" endpos="109:4-1626" class="code"><codecell class="lang-jsx local"><span class="meta"><span class="lang">jsx</span><span class="repl">js</span><span class="filename">test.jsx</span><ul class="attributes"></ul></span><pre><code class="jsx">return (async args =&gt; {

  const React = (await import(&#x27;https://cdn.skypack.dev/react&#x27;)).default
  const { useState } = React
  
  const Clicker = props =&gt; {
    //const [c,setC] = useState(0)
    //console.log(React, useState, c)
    const click = e =&gt; alert(&quot;Clicked ๐ฅณ&quot;) // setC(c+1)

    return &lt;button onClick={click}&gt;{ &quot;Click me&quot;}&lt;/button&gt;
  }

  return &lt;Clicker/&gt;
})()
</code></pre></codecell></cell><cell startpos="113:1-1630" endpos="130:4-1928" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><ul class="attributes"></ul></span><pre><code class="js">return (async args =&gt; {

  const confetti = await 
  import(&#x27;https://cdn.skypack.dev/canvas-confetti&#x27;)

  confetti.default({
     origin: {y: 0},
     spread: 55,
     particleCount: 100,
     ticks: 1000,
  })
  return &quot;yay ๐ฅณ&quot;
})()
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">2 days ago</span></span></span><output><pre><code class="txt">yay ๐ฅณ
</code></pre></output></codecell></cell><cell startpos="132:1-1930" endpos="168:4-3067" class="code"><codecell class="dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span class="filename">current_viewport</span><span class="output">&gt; svg</span><ul class="directives"><li style="color:black;background-color:#da5323"><span class="directive dir-collapse">collapse</span></li></ul><ul class="attributes"></ul></span><pre><code class="js">const b = document.body
const ch = b.clientHeight
const cw = b.clientWidth
const sh = b.scrollHeight
const st = b.scrollTop

const a = cw / ch 
const sa = cw / sh
const c = (ch/2)+st
const cp = c / sh

const h = cw
const w = h * sa
const vt = h * (st/sh)
const vw = w
const vh = h * (ch/sh)
const x = (h/2) - w


const svg = `&lt;svg style=&quot;max-width: 100%;&quot; width=&quot;${h}&quot; height=&quot;${h}&quot;&gt;
  &lt;rect x=&quot;${x}&quot; width=&quot;${w}&quot; height=&quot;${h}&quot; style=&quot;fill:rgb(255,255,255);stroke-width:1;stroke:rgb(0,0,0)&quot; /&gt;
  &lt;rect x=&quot;${x}&quot; y=&quot;${vt}&quot; width=&quot;${vw}&quot; height=&quot;${vh}&quot; style=&quot;fill:rgb(255,255,255);stroke-width:3;stroke:rgb(255,0,0)&quot; /&gt;
&lt;/svg&gt;`

return svg

return {
   ch,cw,sh,st,c,cp,a 
}
</code></pre></codecell><codecell class="lang-svg local output"><span class="meta"><span class="lang">svg</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">2.5 days ago</span></span></span><div><svg style="max-width: 100%;" width="390" height="390">
  <rect x="151.05316382548398" width="43.94683617451604" height="390" style="fill:rgb(255,255,255);stroke-width:1;stroke:rgb(0,0,0)" />
  <rect x="151.05316382548398" y="159.67350476740828" width="43.94683617451604" height="74.82230569199653" style="fill:rgb(255,255,255);stroke-width:3;stroke:rgb(255,0,0)" />
</svg>
</div></codecell></cell></section>
<section depth="3" class="" startpos="182:1-3081" endpos="204:4-3377"><cell startpos="182:1-3081" endpos="182:20-3100"><h3 id="output-markdown">Output Markdown</h3></cell><cell startpos="184:1-3102" endpos="191:4-3268" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; md</span><ul class="attributes"></ul></span><pre><code class="js">console.log(&quot;A __*result*__: **`&quot; +  42/13 + &quot;`**&quot;)
return 42
</code></pre></codecell><codecell class="lang-md local output"><span class="meta"><span class="lang">md</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.5 days ago</span></span></span><div class="md-block">
<p>A <strong><em>result</em></strong>: <strong><code>3.230769230769231</code></strong>
42</p>
</div></codecell></cell><cell startpos="199:1-3276" endpos="204:4-3377" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; json</span><ul class="attributes"></ul></span><pre><code class="js">return { foo: &#x27;bar&#x27;}
</code></pre></codecell><codecell class="lang-json local output"><span class="meta"><span class="lang">json</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.8 days ago</span></span></span><output><pre><code class="json">{ foo: &#x27;bar&#x27; }
</code></pre></output></codecell></cell></section>
<section depth="3" class="" startpos="213:1-3386" endpos="580:4-14739"><cell startpos="213:1-3386" endpos="213:31-3416"><h3 id="meta-lit-global-and-ast">Meta: <code>lit</code> global and AST</h3></cell><cell startpos="239:1-3442" endpos="283:4-4531" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; ast_info !collapse</span><ul class="attributes"></ul></span><pre><code class="js">return this
</code></pre></codecell><codecell class="dir-collapse lang-ast_info local collapsed output"><span class="meta"><span class="lang">ast_info</span><ul class="directives"><li style="color:black;background-color:#da5323"><span class="directive dir-collapse">collapse</span></li></ul><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">2.6 days ago</span></span></span><output><pre><code class="ast_info">{ type: &#x27;root&#x27;,
  children: 
   [ { type: &#x27;section&#x27;,
       data: [Object],
       depth: 1,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 2,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 2,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 3,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 3,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 3,
       children: [Object],
       position: [Object] },
     { type: &#x27;section&#x27;,
       data: [Object],
       depth: 3,
       children: [Object],
       position: [Object] } ],
  position: 
   { start: { line: 1, column: 1, offset: 0 },
     end: { line: 315, column: 1, offset: 4807 } } }
</code></pre></output></codecell></cell><cell startpos="290:1-4538" endpos="298:4-4780" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; litlocation !collapse</span><ul class="attributes"></ul></span><pre><code class="js">return lit.location
</code></pre></codecell><codecell class="dir-collapse lang-litlocation local collapsed output"><span class="meta"><span class="lang">litlocation</span><ul class="directives"><li style="color:black;background-color:#da5323"><span class="directive dir-collapse">collapse</span></li></ul><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.5 days ago</span></span></span><output><pre><code class="litlocation">{ src: &#x27;execute_code_cells.lit&#x27;,
  root: &#x27;/&#x27;,
  base: &#x27;https://dotlit.org/&#x27;,
  query: { file: &#x27;execute_code_cells.lit&#x27; } }
</code></pre></output></codecell></cell><cell startpos="301:1-4783" endpos="328:4-5581" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; lit_utils !collapse</span><ul class="attributes"></ul></span><pre><code class="js">return lit.utils
</code></pre></codecell><codecell class="dir-collapse lang-lit_utils local collapsed output"><span class="meta"><span class="lang">lit_utils</span><ul class="directives"><li style="color:black;background-color:#da5323"><span class="directive dir-collapse">collapse</span></li></ul><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.5 days ago</span></span></span><output><pre><code class="lit_utils">{ select: 
   { matches: [Function: matches],
     selectAll: [Function: selectAll],
     select: [Function: select] },
  path: 
   { resolve: [Function: resolve],
     normalize: [Function: normalize],
     isAbsolute: [Function: isAbsolute],
     join: [Function: join],
     relative: [Function: relative],
     _makeLong: [Function: _makeLong],
     dirname: [Function: dirname],
     basename: [Function: basename],
     extname: [Function: extname],
     format: [Function: format],
     parse: [Function: parse],
     sep: &#x27;/&#x27;,
     delimiter: &#x27;:&#x27;,
     win32: null,
     posix: [Circular] },
  vfile: [Function: VFile],
  delete: [Function: _delete],
  read: [Function: read] }
</code></pre></output></codecell></cell><cell startpos="331:1-5584" endpos="347:4-6007" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><span class="output">&gt; headings !collapse</span><ul class="attributes"></ul></span><pre><code class="js">return lit.utils
          .select
          .selectAll(&#x27;heading&#x27;, ast)
          .map( h =&gt; `${h.depth} ${h.data.id }`)
</code></pre></codecell><codecell class="dir-collapse lang-headings local collapsed output"><span class="meta"><span class="lang">headings</span><ul class="directives"><li style="color:black;background-color:#da5323"><span class="directive dir-collapse">collapse</span></li></ul><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">3.5 days ago</span></span></span><output><pre><code class="headings">[ &#x27;1 executing-code-cells&#x27;,
  &#x27;2 table-of-contents&#x27;,
  &#x27;2 bugs--and-to-do-&#x27;,
  &#x27;2 examples&#x27;,
  &#x27;3 typescript&#x27;,
  &#x27;3 async-and-promises&#x27;,
  &#x27;3 react-jsx&#x27;,
  &#x27;3 output-markdown&#x27;,
  &#x27;3 meta-lit-global-and-ast&#x27; ]
</code></pre></output></codecell></cell><cell startpos="350:1-6010" endpos="364:4-6255" class="code"><codecell class="dir-inline lang-html local"><span class="meta"><span class="lang">html</span><ul class="directives"><li style="color:black;background-color:#b96da2"><span class="directive dir-inline">inline</span></li></ul><ul class="attributes"></ul></span><div><style>
codecell.collapsed.dir-collapse li span.dir-collapse {
  display: none;
}
codecell.dir-error pre {
  border: 2px solid red;
}

codecell.dir-error li span.dir-error {
  background-color: red;
  color: white;
}
</style>
</div></codecell></cell><cell startpos="366:1-6257" endpos="382:4-6547" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><ul class="attributes"></ul></span><pre><code class="js">
const b = document.body
const ch = b.clientHeight
const sh = b.scrollHeight
const st = b.scrollTop

const c = (ch/2)+st
const cp = c / sh

return {
   ch,sh,st,c,cp
}
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">2.6 days ago</span></span></span><output><pre><code class="txt">{ ch: 664, sh: 3475, st: 2811, c: 3143, cp: 0.9044604316546763 }
</code></pre></output></codecell></cell><cell startpos="383:1-6548" endpos="383:16-6563"><p>Trying out git</p></cell><cell startpos="385:1-6565" endpos="580:4-14739" class="code"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span><ul class="attributes"></ul></span><pre><code class="js">return (async args =&gt; {

  const git = (await 
  import(&#x27;https://cdn.skypack.dev/isomorphic-git&#x27;)).default

  return git 
})()
</code></pre></codecell><codecell class="lang-txt local output"><span class="meta"><span class="lang">txt</span><ul class="attributes"></ul><span class="updatedAt">Updated <span class="Time relative">14 hours ago</span></span></span><output><pre><code class="txt">{ Errors: 
   { AlreadyExistsError: { [Function: AlreadyExistsError] code: &#x27;AlreadyExistsError&#x27; },
     AmbiguousError: { [Function: AmbiguousError] code: &#x27;AmbiguousError&#x27; },
     CheckoutConflictError: { [Function: CheckoutConflictError] code: &#x27;CheckoutConflictError&#x27; },
     CommitNotFetchedError: { [Function: CommitNotFetchedError] code: &#x27;CommitNotFetchedError&#x27; },
     EmptyServerResponseError: { [Function: EmptyServerResponseError] code: &#x27;EmptyServerResponseError&#x27; },
     FastForwardError: { [Function: FastForwardError] code: &#x27;FastForwardError&#x27; },
     GitPushError: { [Function: GitPushError] code: &#x27;GitPushError&#x27; },
     HttpError: { [Function: HttpError] code: &#x27;HttpError&#x27; },
     InternalError: { [Function: InternalError] code: &#x27;InternalError&#x27; },
     InvalidFilepathError: { [Function: InvalidFilepathError] code: &#x27;InvalidFilepathError&#x27; },
     InvalidOidError: { [Function: InvalidOidError] code: &#x27;InvalidOidError&#x27; },
     InvalidRefNameError: { [Function: InvalidRefNameError] code: &#x27;InvalidRefNameError&#x27; },
     MaxDepthError: { [Function: MaxDepthError] code: &#x27;MaxDepthError&#x27; },
     MergeNotSupportedError: { [Function: MergeNotSupportedError] code: &#x27;MergeNotSupportedError&#x27; },
     MissingNameError: { [Function: MissingNameError] code: &#x27;MissingNameError&#x27; },
     MissingParameterError: { [Function: MissingParameterError] code: &#x27;MissingParameterError&#x27; },
     NoRefspecError: { [Function: NoRefspecError] code: &#x27;NoRefspecError&#x27; },
     NotFoundError: { [Function: NotFoundError] code: &#x27;NotFoundError&#x27; },
     ObjectTypeError: { [Function: ObjectTypeError] code: &#x27;ObjectTypeError&#x27; },
     ParseError: { [Function: ParseError] code: &#x27;ParseError&#x27; },
     PushRejectedError: { [Function: PushRejectedError] code: &#x27;PushRejectedError&#x27; },
     RemoteCapabilityError: { [Function: RemoteCapabilityError] code: &#x27;RemoteCapabilityError&#x27; },
     SmartHttpError: { [Function: SmartHttpError] code: &#x27;SmartHttpError&#x27; },
     UnknownTransportError: { [Function: UnknownTransportError] code: &#x27;UnknownTransportError&#x27; },
     UnsafeFilepathError: { [Function: UnsafeFilepathError] code: &#x27;UnsafeFilepathError&#x27; },
     UrlParseError: { [Function: UrlParseError] code: &#x27;UrlParseError&#x27; },
     UserCanceledError: { [Function: UserCanceledError] code: &#x27;UserCanceledError&#x27; } },
  STAGE: [Function: STAGE],
  TREE: [Function: TREE],
  WORKDIR: [Function: WORKDIR],
  add: [Function: add],
  addNote: [Function: addNote],
  addRemote: [Function: addRemote],
  annotatedTag: [Function: annotatedTag],
  branch: [Function: branch],
  checkout: [Function: checkout],
  clone: [Function: clone],
  commit: [Function: commit],
  currentBranch: [Function: currentBranch],
  default: 
   { Errors: 
      { AlreadyExistsError: [Object],
        AmbiguousError: [Object],
        CheckoutConflictError: [Object],
        CommitNotFetchedError: [Object],
        EmptyServerResponseError: [Object],
        FastForwardError: [Object],
        GitPushError: [Object],
        HttpError: [Object],
        InternalError: [Object],
        InvalidFilepathError: [Object],
        InvalidOidError: [Object],
        InvalidRefNameError: [Object],
        MaxDepthError: [Object],
        MergeNotSupportedError: [Object],
        MissingNameError: [Object],
        MissingParameterError: [Object],
        NoRefspecError: [Object],
        NotFoundError: [Object],
        ObjectTypeError: [Object],
        ParseError: [Object],
        PushRejectedError: [Object],
        RemoteCapabilityError: [Object],
        SmartHttpError: [Object],
        UnknownTransportError: [Object],
        UnsafeFilepathError: [Object],
        UrlParseError: [Object],
        UserCanceledError: [Object] },
     STAGE: [Function: STAGE],
     TREE: [Function: TREE],
     WORKDIR: [Function: WORKDIR],
     add: [Function: add],
     addNote: [Function: addNote],
     addRemote: [Function: addRemote],
     annotatedTag: [Function: annotatedTag],
     branch: [Function: branch],
     checkout: [Function: checkout],
     clone: [Function: clone],
     commit: [Function: commit],
     getConfig: [Function: getConfig],
     getConfigAll: [Function: getConfigAll],
     setConfig: [Function: setConfig],
     currentBranch: [Function: currentBranch],
     deleteBranch: [Function: deleteBranch],
     deleteRef: [Function: deleteRef],
     deleteRemote: [Function: deleteRemote],
     deleteTag: [Function: deleteTag],
     expandOid: [Function: expandOid],
     expandRef: [Function: expandRef],
     fastForward: [Function: fastForward],
     fetch: [Function: fetch],
     findMergeBase: [Function: findMergeBase],
     findRoot: [Function: findRoot],
     getRemoteInfo: [Function: getRemoteInfo],
     getRemoteInfo2: [Function: getRemoteInfo2],
     hashBlob: [Function: hashBlob],
     indexPack: [Function: indexPack],
     init: [Function: init$1],
     isDescendent: [Function: isDescendent],
     listBranches: [Function: listBranches],
     listFiles: [Function: listFiles],
     listNotes: [Function: listNotes],
     listRemotes: [Function: listRemotes],
     listServerRefs: [Function: listServerRefs],
     listTags: [Function: listTags],
     log: [Function: log],
     merge: [Function: merge],
     packObjects: [Function: packObjects],
     pull: [Function: pull],
     push: [Function: push],
     readBlob: [Function: readBlob],
     readCommit: [Function: readCommit],
     readNote: [Function: readNote],
     readObject: [Function: readObject],
     readTag: [Function: readTag],
     readTree: [Function: readTree],
     remove: [Function: remove],
     removeNote: [Function: removeNote],
     renameBranch: [Function: renameBranch],
     resetIndex: [Function: resetIndex],
     resolveRef: [Function: resolveRef],
     status: [Function: status],
     statusMatrix: [Function: statusMatrix],
     tag: [Function: tag],
     version: [Function: version],
     walk: [Function: walk],
     writeBlob: [Function: writeBlob],
     writeCommit: [Function: writeCommit],
     writeObject: [Function: writeObject],
     writeRef: [Function: writeRef],
     writeTag: [Function: writeTag],
     writeTree: [Function: writeTree] },
  deleteBranch: [Function: deleteBranch],
  deleteRef: [Function: deleteRef],
  deleteRemote: [Function: deleteRemote],
  deleteTag: [Function: deleteTag],
  expandOid: [Function: expandOid],
  expandRef: [Function: expandRef],
  fastForward: [Function: fastForward],
  fetch: [Function: fetch],
  findMergeBase: [Function: findMergeBase],
  findRoot: [Function: findRoot],
  getConfig: [Function: getConfig],
  getConfigAll: [Function: getConfigAll],
  getRemoteInfo: [Function: getRemoteInfo],
  getRemoteInfo2: [Function: getRemoteInfo2],
  hashBlob: [Function: hashBlob],
  indexPack: [Function: indexPack],
  init: [Function: init$1],
  isDescendent: [Function: isDescendent],
  listBranches: [Function: listBranches],
  listFiles: [Function: listFiles],
  listNotes: [Function: listNotes],
  listRemotes: [Function: listRemotes],
  listServerRefs: [Function: listServerRefs],
  listTags: [Function: listTags],
  log: [Function: log],
  merge: [Function: merge],
  packObjects: [Function: packObjects],
  pull: [Function: pull],
  push: [Function: push],
  readBlob: [Function: readBlob],
  readCommit: [Function: readCommit],
  readNote: [Function: readNote],
  readObject: [Function: readObject],
  readTag: [Function: readTag],
  readTree: [Function: readTree],
  remove: [Function: remove],
  removeNote: [Function: removeNote],
  renameBranch: [Function: renameBranch],
  resetIndex: [Function: resetIndex],
  resolveRef: [Function: resolveRef],
  setConfig: [Function: setConfig],
  status: [Function: status],
  statusMatrix: [Function: statusMatrix],
  tag: [Function: tag],
  version: [Function: version],
  walk: [Function: walk],
  writeBlob: [Function: writeBlob],
  writeCommit: [Function: writeCommit],
  writeObject: [Function: writeObject],
  writeRef: [Function: writeRef],
  writeTag: [Function: writeTag],
  writeTree: [Function: writeTree] }
</code></pre></output></codecell></cell></section>
<section depth="2" class="" startpos="582:1-14741" endpos="636:4-16082"><cell startpos="582:1-14741" endpos="586:56-14869"><h2 id="what-if">What if...</h2><p><strong>REPLs</strong> were just custom viewers <a href="renderer/viewers.html?file=renderer/viewers.lit" title="renderer/viewers" wikilink="true">renderer/viewers</a>?</p><p>Implementing clientside execution via custom <code>!viewer</code>.</p></cell><section depth="3" class="" startpos="588:1-14871" endpos="636:4-16082"><cell startpos="588:1-14871" endpos="588:15-14885"><h3 id="first-pass">First pass</h3></cell><cell startpos="590:1-14887" endpos="617:4-15766" class="code"><codecell class="dir-viewer lang-js local"><span class="meta"><span class="lang">js</span><ul class="directives"><li style="color:black;background-color:#cf5332"><span class="directive dir-viewer">viewer</span></li></ul><ul class="attributes"><li style="color:black;background-color:#00dd70"><span class="attribute attr-of">of=esm</span></li></ul></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
  const rce = React.createElement
  const {useState, useEffect} = React
  const [resp, setResp] = useState(null)
  const [run, setRun] = useState(0)
  const exec = () =&gt; setRun(run+1)
  const exec2 = () =&gt; load(node.data.value)
  useEffect(async () =&gt; {
       async function load(src) {
          const val = `//run: ${run}\n${src}`
          const module = await import(`data:text/javascript;base64,${ btoa(src)}`);
         if (typeof module.returns === &#x27;function&#x27;) setResp(await module.returns(run))
         else if (module.returns) setResp(module.returns)
      }

     try {
        load(node.data.value)
     } catch (err) {
        alert(err.message || err.toString())
     }
  }, [run])

  const btn = rce(&#x27;button&#x27;, {onClick: exec}, &quot;Run &quot; + run)
  const t = rce(&#x27;div&#x27;, null, [btn, resp])
  return t
}
</code></pre></codecell></cell><cell startpos="619:1-15768" endpos="625:4-15875" class="code"><codecell class="dir-below lang-esm2 local"><span class="meta"><span class="lang">esm2</span><ul class="directives"><li style="color:white;background-color:#5948c3"><span class="directive dir-below">below</span></li></ul><ul class="attributes"></ul></span><pre><code class="esm2">function foo(baz) {
  alert(&quot;foo II&quot;)
  return &quot;bar:&quot; + baz
}
export const returns = foo
</code></pre></codecell></cell><cell startpos="627:1-15877" endpos="636:4-16082" class="code"><codecell class="dir-below lang-js local"><span class="meta"><span class="lang">js</span><ul class="directives"><li style="color:white;background-color:#5948c3"><span class="directive dir-below">below</span></li></ul><ul class="attributes"><li style="color:black;background-color:#cf5332"><span class="attribute attr-viewer">viewer=esm2</span></li></ul></span><pre><code class="js">import confetti from &#x27;https://cdn.skypack.dev/canvas-confetti&#x27;

export const returns = run =&gt; confetti({
  origin: {y: 0},
  spread: 55,
  particleCount: 100,
  ticks: 1000,
})
</code></pre></codecell></cell></section></section>
<section depth="3" class="" startpos="638:1-16084" endpos="702:4-17698"><cell startpos="638:1-16084" endpos="640:72-16170"><h3 id="version-2">Version 2</h3><p>useEffect for execution on load otherwise require button press to exec.</p></cell><cell startpos="642:1-16172" endpos="672:4-17014" class="code"><codecell class="dir-viewer lang-js local"><span class="meta"><span class="lang">js</span><ul class="directives"><li style="color:black;background-color:#cf5332"><span class="directive dir-viewer">viewer</span></li></ul><ul class="attributes"><li style="color:black;background-color:#00dd70"><span class="attribute attr-of">of=esm2</span></li></ul></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
  const rce = React.createElement
  const {useState, useEffect} = React
  const [resp, setResp] = useState(null)
  const [run, setRun] = useState(0)
  
  const exec = ev =&gt; {
    ev &amp;&amp; ev.stopPropagation()
    setRun(run+1)
    load(node.data.value)
    return false
  }

  useEffect( args =&gt; {
    if(run===0 &amp;&amp; node.properties.meta.exec===&quot;onload&quot;)
       exec()
  },[])

  async function load(src) {
    const val = `//run: ${run}\n${src}`
    const module = await import(`data:text/javascript;base64,${ btoa(src)}`);
    if (typeof module.returns === &#x27;function&#x27;) setResp(await module.returns(run))
    else if (module.returns) setResp(module.returns)
  }

  const btn = rce(&#x27;button&#x27;, {onClick: exec}, &quot;Run &quot; + run)
  const t = rce(&#x27;div&#x27;, null, [btn, resp])
  return t
}
</code></pre></codecell></cell><cell startpos="674:1-17016" endpos="674:38-17053"><p>Setting <code>exec</code> attribute to <code>onload</code></p></cell><cell startpos="676:1-17055" endpos="682:4-17198" class="code"><codecell class="dir-below lang-esm2 local"><span class="meta"><span class="lang">esm2</span><ul class="directives"><li style="color:white;background-color:#5948c3"><span class="directive dir-below">below</span></li></ul><ul class="attributes"><li style="color:black;background-color:#02fb89"><span class="attribute attr-exec">exec=onload</span></li></ul></span><pre><code class="esm2">function output(num) {
  alert(&quot;execd onload!&quot;)
  return &quot;done: &quot; + new Date()
}
export const returns = output()
</code></pre></codecell></cell><cell startpos="685:1-17201" endpos="685:66-17266"><p>Cannot <em>yet</em> output raw DOM nodes, due to react setup of viewers.</p></cell><cell startpos="687:1-17268" endpos="694:4-17436" class="code"><codecell class="dir-below lang-esm2 local"><span class="meta"><span class="lang">esm2</span><ul class="directives"><li style="color:white;background-color:#5948c3"><span class="directive dir-below">below</span></li></ul><ul class="attributes"></ul></span><pre><code class="esm2">function output(num) {
  const dom = document.createElement(&quot;pre&quot;)
  dom.innerHTML = `Run number ${num}`
  return dom
}
export const returns = output
</code></pre></codecell></cell><cell startpos="696:1-17438" endpos="696:155-17592"><p>So far so good, the only issue is that output is entirely ephemeral, how would we enable document modification, ie persist the output as an attached cell.</p></cell><cell startpos="698:1-17594" endpos="702:4-17698" class="code"><codecell class="dir-below lang-esm2 local"><span class="meta"><span class="lang">esm2</span><ul class="directives"><li style="color:white;background-color:#5948c3"><span class="directive dir-below">below</span></li></ul><ul class="attributes"></ul></span><pre><code class="esm2">import git from &#x27;https://cdn.skypack.dev/isomorphic-git&#x27;

export const returns = git 
</code></pre></codecell></cell></section></div></div><div id="backlinks"><h4>Backlinks (3)</h4><ol><li><a title=".lit" href="/index.html">.lit</a></li><li><a title="Title TBD (repl/index.lit)" href="/repl/index.html">Title TBD (repl/index.lit)</a></li><li><a title="Statch Pad" href="/scratch_pad.html">Statch Pad</a></li></ol></div><script src="//cdn.jsdelivr.net/npm/eruda"></script><script>eruda.init();</script><script src="/web.bundle.js"></script></body></html>