<html data-reactroot=""><head><title>Custom Viewers</title><meta name="litsrc" value="/viewers.lit"/><meta name="litroot" value="/"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/><link rel="stylesheet" href="/style.css"/></head><body><div id="lit-app"><div id="lit-header"><menu class="horizontal open has-children"><li class="MenuTitle"><a href="/">Home</a></li><li class="MenuItems"><menu class="has-children" disabled=""><li class="MenuTitle">File</li></menu><menu class="has-children" disabled=""><li class="MenuTitle">Cell</li></menu><menu class="has-children" disabled=""><li class="MenuTitle">Section</li></menu><menu class="has-children" disabled=""><li class="MenuTitle">Help</li></menu><menu class="has-children right"><li class="MenuTitle"><span class="led led-grey"></span><span class="led led-grey"></span><span class="led led-grey"></span></li></menu></li></menu></div><style>body {
  --bg: white;
  --bg-secondary-color: #efefef;
    
  --text-color: black;
  --text-secondary-color: grey;
  --text-primary-color: #9999f7;
  --text-highlight-bg: yellow;
  --text-highlight-color: black;

  --divider-subtle: #efefef;
  --medium-space: 0.4em;

  --code-bg-color: black;
  --code-text-color: white;
  --box-bg-opacity: 0.05;
}</style><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.0.0/build/styles/sunburst.min.css"/><div id="content"><section id="custom-viewers" depth="1" class="" startpos="1:1-0" endpos="3:21-38"><cell startpos="1:1-0" endpos="1:17-16"><div class="cell-content"><h1>Custom Viewers</h1></div></cell><section id="table-of-contents" depth="2" class="" startpos="3:1-18" endpos="3:21-38"><cell startpos="3:1-18" endpos="3:21-38"><div class="cell-content"><h2>Table of Contents</h2><ul>
<li>
<p><a class="fragment" href="#to-do--bugs" filepath="/viewers.lit" root="" data="[object Object]" canonical="#to-do--bugs">To Do / Bugs<span class="linkIcon">§</span></a></p>
</li>
<li>
<p><a class="fragment" href="#examples" filepath="/viewers.lit" root="" data="[object Object]" canonical="#examples">Examples<span class="linkIcon">§</span></a></p>
<ul>
<li><a class="fragment" href="#example-basic-foo-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-basic-foo-viewer">Example: Basic <code>foo</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-dom-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-dom-viewer">Example: DOM Viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-react-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-react-viewer">Example: React viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-css-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-css-viewer">Example: <code>css</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-md-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-md-viewer">Example: <code>md</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-katex-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-katex-viewer">Example: <code>KaTeX</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-meta-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-meta-viewer">Example: <code>meta</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-diff-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-diff-viewer">Example: <code>diff</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-graph-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-graph-viewer">Example: <code>graph</code> viewer<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-vega" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-vega">Example: Vega<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#example-d3-graphviz-dot-viewer" filepath="/viewers.lit" root="" data="[object Object]" canonical="#example-d3-graphviz-dot-viewer">Example: D3 Graphviz <code>dot</code> viewer<span class="linkIcon">§</span></a></li>
</ul>
</li>
<li>
<p><a class="fragment" href="#errors" filepath="/viewers.lit" root="" data="[object Object]" canonical="#errors">Errors<span class="linkIcon">§</span></a></p>
<ul>
<li><a class="fragment" href="#runtime" filepath="/viewers.lit" root="" data="[object Object]" canonical="#runtime">Runtime<span class="linkIcon">§</span></a></li>
<li><a class="fragment" href="#import" filepath="/viewers.lit" root="" data="[object Object]" canonical="#import">Import<span class="linkIcon">§</span></a></li>
</ul>
</li>
<li>
<p><a class="fragment" href="#initial-prototype" filepath="/viewers.lit" root="" data="[object Object]" canonical="#initial-prototype">Initial prototype<span class="linkIcon">§</span></a></p>
</li>
</ul></div></cell></section></section>
<section id="to-do--bugs" depth="2" class="" startpos="5:1-40" endpos="9:31-133"><cell startpos="5:1-40" endpos="9:31-133"><div class="cell-content"><h2>To Do / Bugs</h2><ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->Doppelgänger page?</li>
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->Error handling</li>
<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> <!-- -->Sharing across documents</li>
</ul></div></cell></section>
<section id="examples" depth="2" class="" startpos="11:1-135" endpos="48:4-506"><cell startpos="11:1-135" endpos="11:12-146"><div class="cell-content"><h2>Examples</h2></div></cell><section id="example-basic-foo-viewer" depth="3" class="" startpos="13:1-148" endpos="48:4-506"><cell startpos="13:1-148" endpos="13:32-179"><div class="cell-content"><h3>Example: Basic <code>foo</code> viewer</h3></div></cell><cell startpos="15:1-181" endpos="19:4-277" class="code"><div class="cell-content"><codecell class="dir-plugin lang-js local"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=foo</span></span><pre><code class="js">export const viewer = ({node}) =&gt; {
  return `${node.value} Foooooo!`
}
</code></pre></codecell></div></cell><cell startpos="22:1-280" endpos="22:30-309"><div class="cell-content"><p>Not used in the default case:</p></div></cell><cell startpos="24:1-311" endpos="26:4-325" class="code"><div class="cell-content"><codecell class="lang-foo local"><span class="meta"><span class="lang">foo</span></span><pre><code class="foo">Bar
</code></pre></codecell></div></cell><cell startpos="28:1-327" endpos="28:41-367"><div class="cell-content"><p>Only when using the <code>!inline</code> directive:</p></div></cell><cell startpos="30:1-369" endpos="32:4-393" class="code"><div class="cell-content"><codecell class="dir-inline lang-foo local"><span class="meta"><span class="lang">foo</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span></span>Baz 1
 Foooooo!</codecell></div></cell><cell startpos="38:1-399" endpos="38:38-436"><div class="cell-content"><p>or <code>viewer=xxx</code> attribute is present:</p></div></cell><cell startpos="40:1-438" endpos="42:4-463" class="code"><div class="cell-content"><codecell class="lang-bar local"><span class="meta"><span class="lang">bar</span><span class="attribute attr-viewer" style="color:black;background-color:#cf5332">viewer=foo</span></span>Quz
 Foooooo!</codecell></div></cell><cell startpos="44:1-465" endpos="44:25-489"><div class="cell-content"><p>or it is an output cell:</p></div></cell><cell startpos="46:1-491" endpos="48:4-506" class="code output"><div class="cell-content"><codecell class="lang-foo local output"><span class="meta"><span class="lang">foo</span></span>Qux
 Foooooo!</codecell></div></cell></section></section>
<section id="example-dom-viewer" depth="3" class="" startpos="51:1-509" endpos="63:4-772"><cell startpos="51:1-509" endpos="51:24-532"><div class="cell-content"><h3>Example: DOM Viewer</h3></div></cell><cell startpos="53:1-534" endpos="59:4-760" class="code"><div class="cell-content"><codecell class="dir-plugin lang-js local"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=dom</span></span><pre><code class="js">export const viewer = ({node,React}) =&gt; {
   const p = document.createElement(&#x27;p&#x27;);
   p.innerHTML = &quot;A paragraph&quot;
   return &lt;div ref={(nodeElement) =&gt; {nodeElement &amp;&amp; nodeElement.appendChild(p)}}/&gt;
}
</code></pre></codecell></div></cell><cell startpos="61:1-762" endpos="63:4-772" class="code"><div class="cell-content"><codecell class="lang-js local"><span class="meta"><span class="lang">js</span></span><pre><code class="js"></code></pre></codecell></div></cell></section>
<section id="example-react-viewer" depth="3" class="" startpos="65:1-774" endpos="87:4-1289"><cell startpos="65:1-774" endpos="65:26-799"><div class="cell-content"><h3>Example: React viewer</h3></div></cell><cell startpos="67:1-801" endpos="83:4-1253" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=bar</span></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
  const rc = React.createElement
  const {useState, useEffect} = React
  const meta = node.properties 
               &amp;&amp; node.properties.meta
  const [content, setContent] = useState(&#x27;Loading...&#x27;)
  const src = node.data.value
  useEffect(()=&gt;{
    setContent(&quot;Loaded. &quot; + node.data.value)
  },[src])

  return rc(&#x27;div&#x27;, {
    className: &#x27;custom-react-view&#x27;,
  }, content)
}
</code></pre></codecell></div></cell><cell startpos="85:1-1255" endpos="87:4-1289" class="code"><div class="cell-content"><codecell class="dir-below lang-bar local"><span class="meta"><span class="lang">bar</span><span style="color:white;background-color:#5948c3" class="directive dir-below">below</span></span><pre><code class="bar">Custom Content 3
</code></pre><div class="custom-react-view">Loading...</div></codecell></div></cell></section>
<section id="example-css-viewer" depth="3" class="" startpos="89:1-1291" endpos="123:4-2081"><cell startpos="89:1-1291" endpos="89:26-1316"><div class="cell-content"><h3>Example: <code>css</code> viewer</h3></div></cell><cell startpos="91:1-1318" endpos="110:4-1701" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=css</span></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
  const rc = React.createElement
  const meta = node.properties 
               &amp;&amp; node.properties.meta

  const link = meta &amp;&amp; meta.uri

  if (link) return rc(&#x27;link&#x27;, {
    rel: &#x27;stylesheet&#x27;,
    href: link
  })

  return rc(&#x27;style&#x27;, {
    dangerouslySetInnerHTML: {
      __html: node.value
    }
  })
}
</code></pre></codecell></div></cell><cell startpos="112:1-1703" endpos="117:4-1781" class="code output"><div class="cell-content"><codecell class="dir-below lang-css local output"><span class="meta"><span class="lang">css</span><span style="color:white;background-color:#5948c3" class="directive dir-below">below</span></span><pre><code class="css">#lit-header {
  color: purple;
  font-family: sans-serif;
}
</code></pre><style>#lit-header {
  color: purple;
  font-family: sans-serif;
}
</style></codecell></div></cell><cell startpos="119:1-1783" endpos="120:4-1901" class="code"><div class="cell-content"><codecell class="dir-inline dir-hidemeta lang-css local"><span class="meta"><span class="lang">css</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span><span style="color:white;background-color:#964f82" class="directive dir-hidemeta">hidemeta</span></span><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/solarized-light.min.css"/></codecell></div></cell><cell startpos="121:1-1902" endpos="123:4-2081" class="code output"><div class="cell-content"><codecell class="dir-inline dir-info lang-md local output"><span class="meta"><span class="lang">md</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span><span style="color:white;background-color:#03164a" class="directive dir-info">info</span></span><div class="md-block dir-inline dir-info">
<p>👀 There is an invisible <code>css</code> cell (using <code>!inline</code> and <code>!hidemeta</code> directives) above which pulls a new solarised light highlight.js theme into the page.</p>
</div></codecell></div></cell></section>
<section id="example-md-viewer" depth="3" class="" startpos="125:1-2083" endpos="165:4-2542"><cell startpos="125:1-2083" endpos="127:92-2200"><div class="cell-content"><h3>Example: <code>md</code> viewer</h3><p>Less of an example but rather a work in progress before moving it into <code>.lit</code> as a default.</p></div></cell><cell startpos="129:1-2202" endpos="131:4-2268" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=md</span><span class="source">&lt; plugins/viewers/md/index.jsx</span></span><pre><code class="js">export const viewer = ({children,node, React}) =&gt; {

  const ch = children
  const chc = ch[0].props.children
  const rc = React.createElement
  const np = node.properties

  const meta = np &amp;&amp; np.meta
  const dirs = meta &amp;&amp; meta.directives
  const tags = meta &amp;&amp; meta.tags
  
  const dc = dirs &amp;&amp; dirs.map(d=&gt;&#x27;dir-&#x27;+d)
  const tc = tags &amp;&amp; tags.map(t=&gt;&#x27;tag-&#x27;+t)

  const classes = [&#x27;md-block&#x27;]
  const add = arr =&gt; arr.forEach( c =&gt; { 
                        classes.push(c)
                     })
  if (dc) add(dc)
  if (tc) add(tc)

  const className = classes
                    .filter(x=&gt;x)
                    .join(&#x27; &#x27;)
                    .trim()

  return rc(&#x27;div&#x27;, {className}, chc)
}

</code></pre></codecell></div></cell><cell startpos="137:1-2274" endpos="139:4-2317" class="code"><div class="cell-content"><codecell class="dir-below lang-md local"><span class="meta"><span class="lang">md</span><span style="color:white;background-color:#5948c3" class="directive dir-below">below</span></span><pre><code class="md">*Markdown* Viewer **DONE**
</code></pre><div class="md-block dir-below">
<p><em>Markdown</em> Viewer <strong>DONE</strong></p>
</div></codecell></div></cell><cell startpos="141:1-2319" endpos="143:4-2357" class="code output"><div class="cell-content"><codecell class="lang-md local output"><span class="meta"><span class="lang">md</span></span><div class="md-block">
<p><em>Markdown</em> Viewer <strong>FIXED</strong></p>
</div></codecell></div></cell><cell startpos="155:1-2369" endpos="159:4-2485" class="code"><div class="cell-content"><codecell class="dir-success lang-md local"><span class="meta"><span class="lang">md</span><span style="color:black;background-color:#90b540" class="directive dir-success">success</span><span class="attribute attr-viewer" style="color:black;background-color:#cf5332">viewer=md</span></span><div class="md-block dir-success">
<p><strong>✅ Admonitions</strong></p>
<p>See <a class="exists local" href="plugins/viewers/md/admonitions.html" title="plugins/viewers/md/admonitions" wikilink="true" filepath="/viewers.lit" root="" data="[object Object]" canonical="/plugins/viewers/md/admonitions.lit">plugins/viewers/md/admonitions</a> for more examples and usages.</p>
</div></codecell></div></cell><cell startpos="161:1-2487" endpos="165:4-2542" class="code"><div class="cell-content"><codecell class="dir-inline lang-md local"><span class="meta"><span class="lang">md</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span></span><div class="md-block dir-inline">
<codecell class="local"><pre><code class="plaintext"></code></pre></codecell>
</div></codecell></div></cell></section>
<section id="example-katex-viewer" depth="3" class="" startpos="167:1-2544" endpos="188:4-3775"><cell startpos="167:1-2544" endpos="167:28-2571"><div class="cell-content"><h3>Example: <code>KaTeX</code> viewer</h3></div></cell><cell startpos="169:1-2573" endpos="188:4-3775" class="code"><div class="cell-content"><codecell class="dir-inline lang-html local"><span class="meta"><span class="lang">html</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span><span class="attribute attr-viewer" style="color:black;background-color:#cf5332">viewer=iframe</span></span><iframe srcDoc="&lt;!DOCTYPE html&gt;
&lt;!-- KaTeX requires the use of the HTML5 doctype. Without it, KaTeX may not render properly --&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css&quot; integrity=&quot;sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5&quot; crossorigin=&quot;anonymous&quot;&gt;

    &lt;!-- The loading of KaTeX is deferred to speed up page rendering --&gt;
    &lt;script defer src=&quot;https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js&quot; integrity=&quot;sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;

    &lt;!-- To automatically render math in text elements, include the auto-render extension: --&gt;
    &lt;script defer src=&quot;https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js&quot; integrity=&quot;sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl&quot; crossorigin=&quot;anonymous&quot;
        onload=&quot;katex.render(document.body.innerHTML, document.body,{throwOnError: false});&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;% \f is defined as #1f(#2) using the macro
\f\relax{x} = \int_{-\infty}^\infty
    \f\hat\xi\,e^{2 \pi i \xi x}
    \,d\xi&lt;/body&gt;
&lt;/html&gt;
" style="aspect-ratio:1.6"></iframe></codecell></div></cell></section>
<section id="example-meta-viewer" depth="3" class="" startpos="191:1-3778" endpos="207:4-4214"><cell startpos="191:1-3778" endpos="191:27-3804"><div class="cell-content"><h3>Example: <code>meta</code> viewer</h3></div></cell><cell startpos="192:1-3805" endpos="201:4-4122" class="code output"><div class="cell-content"><codecell class="dir-plugin lang-js local output"><a name="viewers/meta.js"></a><span class="meta"><span class="lang">js</span><span class="filename">viewers/meta.js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=meta</span></span><output><pre><code class="js">export const viewer = ({node,React}) =&gt; {
  const {useEffect, useState} = React
  const [output,setOutput] = useState(&quot;Loading...&quot;)
  useEffect(()=&gt;{
    setOutput(lit.utils.inspect(node))
  }, [node])
  return React.createElement(&#x27;pre&#x27;, {style: {color: &#x27;black&#x27;}}, output)
}
</code></pre></output></codecell></div></cell><cell startpos="205:1-4126" endpos="207:4-4214" class="code"><div class="cell-content"><codecell class="dir-below lang-txt local"><span class="meta"><span class="lang">txt</span><span style="color:white;background-color:#5948c3" class="directive dir-below">below</span><span class="attribute attr-viewer" style="color:black;background-color:#cf5332">viewer=meta</span><span class="source">&lt; dummy/plain.txt</span><span class="output">&gt; lang file.ext</span></span><pre><code class="txt">A
</code></pre></codecell></div></cell></section>
<section id="example-diff-viewer" depth="3" class="" startpos="209:1-4216" endpos="394:4-8681"><cell startpos="209:1-4216" endpos="213:51-4375"><div class="cell-content"><h3>Example: <code>diff</code> viewer</h3><p>v1 <code>https://cdn.skypack.dev/diff</code> didn&#x27;t work (via skyPack) but added to utils.</p><p>v2 <code>https://github.com/praneshr/react-diff-viewer</code></p></div></cell><cell startpos="215:1-4377" endpos="269:4-5541" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=diff</span></span><pre><code class="js">import diff from &#x27;https://cdn.skypack.dev/react-diff-viewer&#x27;
export const viewer = ({node,React}) =&gt; {
  const rc = React.createElement
 const {useState, useEffect} = React
  const meta = node.properties 
               &amp;&amp; node.properties.meta
  const [content, setContent] = useState(&#x27;Loading...&#x27;)
  const src = node.data.value
  useEffect(async () =&gt; {

  const styles = {
    lineNumber: {
      fontWeight: &#x27;bold&#x27;
    },
    gutter: {
      minWidth: &#x27;0.6em&#x27;,
      padding: &#x27;0 0.2em&#x27;,
    },
    marker: {
      width: &#x27;auto&#x27;,
      padding: &#x27;0 0.2em&#x27;
    },
    contentText: {
      lineHeight: &#x27;1em !important&#x27;,
      wordBreak: &#x27;break-all&#x27;,
    },
    content: {
      width: &#x27;auto&#x27;,
      padding: 0,
    }
  }

  const view = rc(diff, {
    newValue: node.properties.data.originalSource,
    rightTitle: &#x27;local&#x27;,
    oldValue: src,
    leftTitle: &#x27;remote&#x27;,
    splitView: meta &amp;&amp; meta.split === &#x27;true&#x27;,
    styles,
    compareMethod: diff[(meta &amp;&amp; meta.method &amp;&amp; meta.method.toUpperCase()) || &#x27;CHARS&#x27;]
  })


    setContent(view)
  },[src])

  

  return rc(&#x27;div&#x27;, {
    className: &#x27;custom-diff-view&#x27;,
  }, content)

}
</code></pre></codecell></div></cell><cell startpos="270:1-5542" endpos="276:4-5796" class="code"><div class="cell-content"><codecell class="dir-inline lang-diff local"><span class="meta"><span class="lang">diff</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span><span class="source">&lt; dummy/plain.txt</span></span><pre><code class="diff">A
</code></pre></codecell></div></cell><cell startpos="277:1-5797" endpos="330:4-7162" class="code output"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed output"><a name="diff"></a><span class="meta"><span class="lang">js</span><span class="filename">plugins/modal/diff.js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-type" style="color:white;background-color:#0368f3">type=filemenu</span><span class="attribute attr-id" style="color:black;background-color:#00d1b0">id=diff</span></span><output><pre><code class="js">import diff from &quot;https://cdn.skypack.dev/react-diff-viewer&quot;;

export const filemenu = (ctx, { React, Menu, toggleModal }) =&gt; {
  const rc = React.createElement;

  const showDiff = async () =&gt; {
    const close = rc(&quot;button&quot;, { onClick: () =&gt; toggleModal() }, [&quot;Close&quot;]);

    const styles = {
      lineNumber: {
        fontWeight: &quot;bold&quot;,
      },
      gutter: {
        minWidth: &quot;0.6em&quot;,
        padding: &quot;0 0.2em&quot;,
      },
      marker: {
        width: &quot;auto&quot;,
        padding: &quot;0 0.2em&quot;,
      },
      contentText: {
        lineHeight: &quot;1em !important&quot;,
        wordBreak: &quot;break-all&quot;,
      },
      content: {
        width: &quot;auto&quot;,
        padding: 0,
      },
    };
    const stats = await lit.fs.readStat(lit.location.src, { encoding: &quot;utf8&quot; });
    if (stats.local.value === stats.remote.value) {
      toggleModal(rc(&quot;div&quot;, {}, [close, &quot;Local and Remote match. (No Diff)&quot;]));
      return;
    }

    const view = rc(diff, {
      newValue: stats.local.value,
      rightTitle: &quot;local&quot;,
      oldValue: stats.remote.value,
      leftTitle: &quot;remote&quot;,
      splitView: false,
      styles,
      compareMethod: diff[&quot;CHARS&quot;],
    });

    const modal = rc(&quot;div&quot;, {}, [close, view]);
    toggleModal(modal);
  };

  return rc(&quot;span&quot;, { onClick: showDiff }, &quot;Show Diff&quot;);
};

</code></pre></output></codecell></div></cell><cell startpos="332:1-7164" endpos="391:4-8612" class="code output"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed output"><a name="plugins/viewer/diff.js"></a><span class="meta"><span class="lang">js</span><span class="filename">plugins/viewer/diff.js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=diff2</span></span><output><pre><code class="js">import diff from &quot;https://cdn.skypack.dev/react-diff-viewer&quot;;

export const viewer = ({ node, React }) =&gt; {
  const rc = React.createElement;
  const { useState, useEffect } = React;
  const meta = node.properties &amp;&amp; node.properties.meta;
  const [content, setContent] = useState(&quot;Loading...&quot;);
  const src = node.data.value;
  useEffect(async () =&gt; {
    const styles = {
      lineNumber: {
        fontWeight: &quot;bold&quot;,
      },
      gutter: {
        minWidth: &quot;0.6em&quot;,
        padding: &quot;0 0.2em&quot;,
      },
      marker: {
        width: &quot;auto&quot;,
        padding: &quot;0 0.2em&quot;,
      },
      contentText: {
        lineHeight: &quot;1em !important&quot;,
        wordBreak: &quot;break-all&quot;,
      },
      content: {
        width: &quot;auto&quot;,
        padding: 0,
      },
    };
    const stats = await lit.fs.readStat(src);
    if (stats.local.value === stats.remote.value) {
      setContent(&quot;Local and Remote match. (No Diff)&quot;);
      return;
    }

    const view = rc(diff, {
      newValue: stats.local.value,
      rightTitle: &quot;local&quot;,
      oldValue: stats.remote.value,
      leftTitle: &quot;remote&quot;,
      splitView: meta &amp;&amp; meta.split === &quot;true&quot;,
      styles,
      compareMethod:
        diff[(meta &amp;&amp; meta.method &amp;&amp; meta.method.toUpperCase()) || &quot;CHARS&quot;],
    });

    setContent(view);
  }, [src]);

  return rc(
    &quot;div&quot;,
    {
      className: &quot;custom-diff-view&quot;,
    },
    content
  );
};
</code></pre></output></codecell></div></cell><cell startpos="392:1-8613" endpos="394:4-8681" class="code output"><div class="cell-content"><codecell class="lang-diff2 local output"><span class="meta"><span class="lang">diff2</span><span class="attribute attr-method" style="color:black;background-color:#bfc5d0">method=chars</span></span><output><pre><code class="diff2">/testing/fuzzy_text_search.lit
</code></pre></output></codecell></div></cell></section>
<section id="example-graph-viewer" depth="3" class="" startpos="396:1-8683" endpos="462:92-10501"><cell startpos="396:1-8683" endpos="398:73-8784"><div class="cell-content"><h3>Example: <code>graph</code> viewer</h3><p>✅ This viewer has been folded into <code>.lit</code> as one of the default viewers.</p></div></cell><cell startpos="400:1-8786" endpos="445:4-10217" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=custom-graph</span></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
   const c = React.createElement
   const data = node.value

   const el = c(&#x27;iframe&#x27;, {srcDoc: `&lt;head&gt;
  &lt;style&gt; body { margin: 0; } &lt;/style&gt;
  &lt;script src=&quot;https://unpkg.com/force-graph&quot;&gt;&lt;/script&gt;
  &lt;!-- from: https://github.com/vasturiano/force-graph --&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;graph&quot;&gt;&lt;/div&gt;
  &lt;script&gt;
    const data = ${data};
      const thisfile = window.parent.lit.location.src
      // alert(thisfile)
      const elem = document.getElementById(&#x27;graph&#x27;)
      const Graph = ForceGraph()(elem)
        .graphData(data)
        .nodeId(&#x27;id&#x27;)
        .nodeVal((n) =&gt; 2 * (n.backlinks &amp;&amp; n.backlinks.length ? n.backlinks.length : 1))
        .nodeLabel(&#x27;id&#x27;)
        .nodeAutoColorBy(&#x27;type&#x27;)
        
        // .linkColor(d =&gt; data.nodes[d.source].exists ? &#x27;red&#x27; : &#x27;lightblue&#x27;)
        .linkDirectionalArrowLength(6)
        .onNodeHover(node =&gt; elem.style.cursor = node ? &#x27;pointer&#x27; : null)
        .onNodeClick(node =&gt; {
          // Center/zoom on node
          Graph.centerAt(node.x, node.y, 1000);
          Graph.zoom(2, 2000);
        });

        setTimeout( () =&gt; {
            const { nodes, links } = Graph.graphData()
            const node = nodes.filter( n =&gt; n.id === thisfile)[0]
            Graph.centerAt(node.x, node.y, 1000);
            Graph.zoom(2, 2000);

        }, 2000)

  &lt;/script&gt;
&lt;/body&gt;`})
   return el
}
</code></pre></codecell></div></cell><cell startpos="447:1-10219" endpos="457:4-10360" class="code"><div class="cell-content"><codecell class="dir-inline lang-custom-graph local"><span class="meta"><span class="lang">custom-graph</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span></span><iframe srcDoc="&lt;head&gt;
  &lt;style&gt; body { margin: 0; } &lt;/style&gt;
  &lt;script src=&quot;https://unpkg.com/force-graph&quot;&gt;&lt;/script&gt;
  &lt;!-- from: https://github.com/vasturiano/force-graph --&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;graph&quot;&gt;&lt;/div&gt;
  &lt;script&gt;
    const data = {
  &quot;nodes&quot;:[
    {&quot;id&quot;: &quot;foo&quot;},
    {&quot;id&quot;: &quot;bar&quot;}
  ],
  &quot;links&quot;: [
    {&quot;source&quot;: &quot;foo&quot;, &quot;target&quot;: &quot;bar&quot;}
  ]
}
;
      const thisfile = window.parent.lit.location.src
      // alert(thisfile)
      const elem = document.getElementById(&#x27;graph&#x27;)
      const Graph = ForceGraph()(elem)
        .graphData(data)
        .nodeId(&#x27;id&#x27;)
        .nodeVal((n) =&gt; 2 * (n.backlinks &amp;&amp; n.backlinks.length ? n.backlinks.length : 1))
        .nodeLabel(&#x27;id&#x27;)
        .nodeAutoColorBy(&#x27;type&#x27;)
        
        // .linkColor(d =&gt; data.nodes[d.source].exists ? &#x27;red&#x27; : &#x27;lightblue&#x27;)
        .linkDirectionalArrowLength(6)
        .onNodeHover(node =&gt; elem.style.cursor = node ? &#x27;pointer&#x27; : null)
        .onNodeClick(node =&gt; {
          // Center/zoom on node
          Graph.centerAt(node.x, node.y, 1000);
          Graph.zoom(2, 2000);
        });

        setTimeout( () =&gt; {
            const { nodes, links } = Graph.graphData()
            const node = nodes.filter( n =&gt; n.id === thisfile)[0]
            Graph.centerAt(node.x, node.y, 1000);
            Graph.zoom(2, 2000);

        }, 2000)

  &lt;/script&gt;
&lt;/body&gt;"></iframe></codecell></div></cell><cell startpos="459:1-10362" endpos="460:4-10408" class="code"><div class="cell-content"><codecell class="dir-inline lang-custom-graph local"><span class="meta"><span class="lang">custom-graph</span><span style="color:black;background-color:#b96da2" class="directive dir-inline">inline</span><span class="source">&lt; ../manifest.json</span></span><iframe srcDoc="&lt;head&gt;
  &lt;style&gt; body { margin: 0; } &lt;/style&gt;
  &lt;script src=&quot;https://unpkg.com/force-graph&quot;&gt;&lt;/script&gt;
  &lt;!-- from: https://github.com/vasturiano/force-graph --&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;graph&quot;&gt;&lt;/div&gt;
  &lt;script&gt;
    const data = undefined;
      const thisfile = window.parent.lit.location.src
      // alert(thisfile)
      const elem = document.getElementById(&#x27;graph&#x27;)
      const Graph = ForceGraph()(elem)
        .graphData(data)
        .nodeId(&#x27;id&#x27;)
        .nodeVal((n) =&gt; 2 * (n.backlinks &amp;&amp; n.backlinks.length ? n.backlinks.length : 1))
        .nodeLabel(&#x27;id&#x27;)
        .nodeAutoColorBy(&#x27;type&#x27;)
        
        // .linkColor(d =&gt; data.nodes[d.source].exists ? &#x27;red&#x27; : &#x27;lightblue&#x27;)
        .linkDirectionalArrowLength(6)
        .onNodeHover(node =&gt; elem.style.cursor = node ? &#x27;pointer&#x27; : null)
        .onNodeClick(node =&gt; {
          // Center/zoom on node
          Graph.centerAt(node.x, node.y, 1000);
          Graph.zoom(2, 2000);
        });

        setTimeout( () =&gt; {
            const { nodes, links } = Graph.graphData()
            const node = nodes.filter( n =&gt; n.id === thisfile)[0]
            Graph.centerAt(node.x, node.y, 1000);
            Graph.zoom(2, 2000);

        }, 2000)

  &lt;/script&gt;
&lt;/body&gt;"></iframe></codecell></div></cell><cell startpos="462:1-10410" endpos="462:92-10501"><div class="cell-content"><p>The above automatically transcludes the <code>.lit</code> manifest and focuses on the current document</p></div></cell></section>
<section id="example-vega" depth="3" class="" startpos="463:1-10502" endpos="504:4-11932"><cell startpos="463:1-10502" endpos="466:71-10619"><div class="cell-content"><h3>Example: Vega</h3><p>Still a <em>Work in progress</em>
Docs: <a class="external" href="https://vega.github.io/vega-lite/usage/compile.html" filepath="/viewers.lit" root="" data="[object Object]" canonical="https://vega.github.io/vega-lite/usage/compile.html">vega-lite<span class="linkIcon">↗</span></a></p></div></cell><cell startpos="470:1-10623" endpos="482:4-10933" class="code"><div class="cell-content"><codecell class="dir-plugin lang-js local"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span class="attribute attr-type" style="color:white;background-color:#0368f3">type=viewer</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=vega</span></span><pre><code class="js">import { VegaLite } from &quot;https://cdn.skypack.dev/react-vega&quot;;
export const viewer = ({ node, React }) =&gt; {
  let spec, error;
  try {
    spec = JSON.parse(node.data.value);
  } catch (err) {
    error = error.message;
  }
  return error || &lt;VegaLite spec={spec} /&gt;;
};

</code></pre></codecell></div></cell><cell startpos="484:1-10935" endpos="504:4-11932" class="code"><div class="cell-content"><codecell class="dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="output">&gt; vega</span></span><pre><code class="js">
const events = Object.keys(lit.timings.client.timeTo)
const data = events.map( e =&gt; ({event:e||&#x27;start&#x27;, time: lit.timings.client.timeTo[e||&#x27;start&#x27;]}))
return JSON.stringify({
  // $schema: &#x27;https://vega.github.io/schema/vega-lite/v5.json&#x27;,
  description: &quot;A simple bar chart with embedded data.&quot;,
  data: {
    values: data
  },
  mark: &quot;bar&quot;,
  encoding: {
    x: { field: &quot;event&quot;, type: &quot;ordinal&quot; },
    y: { field: &quot;time&quot;, type: &quot;quantitative&quot; },
  },
});

</code></pre></codecell><codecell class="lang-vega local output"><span class="meta"><span class="lang">vega</span><span class="updatedAt">Updated <span class="Time relative">3.3w ago</span></span></span><output><pre><code class="vega">{&quot;description&quot;:&quot;A simple bar chart with embedded data.&quot;,&quot;data&quot;:{&quot;values&quot;:[{&quot;event&quot;:&quot;importsComplete&quot;,&quot;time&quot;:104},{&quot;event&quot;:&quot;fsSetup&quot;,&quot;time&quot;:105},{&quot;event&quot;:&quot;litObj&quot;,&quot;time&quot;:105},{&quot;event&quot;:&quot;initStart&quot;,&quot;time&quot;:105},{&quot;event&quot;:&quot;readFile&quot;,&quot;time&quot;:1317},{&quot;event&quot;:&quot;manifestLoaded&quot;,&quot;time&quot;:1594},{&quot;event&quot;:&quot;processedFile&quot;,&quot;time&quot;:6427},{&quot;event&quot;:&quot;rendered&quot;,&quot;time&quot;:6648}]},&quot;mark&quot;:&quot;bar&quot;,&quot;encoding&quot;:{&quot;x&quot;:{&quot;field&quot;:&quot;event&quot;,&quot;type&quot;:&quot;ordinal&quot;},&quot;y&quot;:{&quot;field&quot;:&quot;time&quot;,&quot;type&quot;:&quot;quantitative&quot;}}}
</code></pre></output></codecell></div></cell></section>
<section id="example-d3-graphviz-dot-viewer" depth="3" class="" startpos="515:1-11943" endpos="572:95-13205"><cell startpos="515:1-11943" endpos="517:53-12034"><div class="cell-content"><h3>Example: D3 Graphviz <code>dot</code> viewer</h3><p>Docs: <a class="external" href="https://github.com/magjac/d3-graphviz#examples" filepath="/viewers.lit" root="" data="[object Object]" canonical="https://github.com/magjac/d3-graphviz#examples">https://github.com/magjac/d3-graphviz#examples<span class="linkIcon">↗</span></a></p></div></cell><cell startpos="519:1-12036" endpos="537:4-12599" class="code"><div class="cell-content"><codecell class="dir-plugin dir-collapse lang-js local collapsed"><span class="meta"><span class="lang">js</span><span style="color:white;background-color:#c5476f" class="directive dir-plugin">plugin</span><span style="color:black;background-color:#da5323" class="directive dir-collapse">collapse</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=dot</span></span><pre><code class="js">export const viewer = ({node, React}) =&gt; {
   const c = React.createElement
   const el = c(&#x27;iframe&#x27;, {srcDoc: `&lt;!DOCTYPE html&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;body&gt;
&lt;script src=&quot;//d3js.org/d3.v5.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js&quot;&gt;&lt;/script&gt;
&lt;div id=&quot;graph&quot; style=&quot;text-align: center;&quot;&gt;&lt;/div&gt;
&lt;script&gt;

d3.select(&quot;#graph&quot;).graphviz()
    .renderDot(&#x27;${node.value.trim()}&#x27;);

&lt;/script&gt;`})
   return el
}
</code></pre></codecell></div></cell><cell startpos="539:1-12601" endpos="541:4-12645" class="code output"><div class="cell-content"><codecell class="lang-dot local output"><span class="meta"><span class="lang">dot</span><span class="attribute attr-xviewer" style="color:white;background-color:#9b3ef8">xviewer=meta</span></span><iframe srcDoc="&lt;!DOCTYPE html&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;body&gt;
&lt;script src=&quot;//d3js.org/d3.v5.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js&quot;&gt;&lt;/script&gt;
&lt;div id=&quot;graph&quot; style=&quot;text-align: center;&quot;&gt;&lt;/div&gt;
&lt;script&gt;

d3.select(&quot;#graph&quot;).graphviz()
    .renderDot(&#x27;digraph  { a -&gt; b }&#x27;);

&lt;/script&gt;"></iframe></codecell></div></cell><cell startpos="543:1-12647" endpos="570:4-13109" class="code output"><div class="cell-content"><codecell class="lang-dot local output"><span class="meta"><span class="lang">dot</span></span><iframe srcDoc="&lt;!DOCTYPE html&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;body&gt;
&lt;script src=&quot;//d3js.org/d3.v5.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js&quot;&gt;&lt;/script&gt;
&lt;div id=&quot;graph&quot; style=&quot;text-align: center;&quot;&gt;&lt;/div&gt;
&lt;script&gt;

d3.select(&quot;#graph&quot;).graphviz()
    .renderDot(&#x27;digraph Q {

  node [shape=record];


  nd_1   [label = &quot;Node 1&quot;];
  nd_2   [label = &quot;Node 2&quot;];
  nd_3_a [label = &quot;Above Right Node 3&quot;];
  nd_3_l [label = &quot;Left of Node 3&quot;];
  nd_3   [label = &quot;Node 3&quot;];
  nd_3_r [label = &quot;Right of Node 3&quot;];
  nd_4   [label = &quot;Node 4&quot;];


  nd_3_a -&gt; nd_3_r;
  nd_1 -&gt; nd_2 -&gt; nd_3 -&gt; nd_4;

  subgraph cluster_R {

    {rank=same nd_3_l nd_3 nd_3_r}

    nd_3_l -&gt; nd_3 -&gt; nd_3_r [color=grey arrowhead=none];

  }

}&#x27;);

&lt;/script&gt;"></iframe></codecell></div></cell><cell startpos="572:1-13111" endpos="572:95-13205"><div class="cell-content"><p>The above mildly more complex example doesn&#x27;t render, likely due to not being actual graphviz.</p></div></cell></section>
<section id="errors" depth="2" class="" startpos="576:1-13209" endpos="597:4-13580"><cell startpos="576:1-13209" endpos="576:10-13218"><div class="cell-content"><h2>Errors</h2></div></cell><section id="runtime" depth="3" class="" startpos="578:1-13220" endpos="597:4-13580"><cell startpos="578:1-13220" endpos="578:12-13231"><div class="cell-content"><h3>Runtime</h3></div></cell><cell startpos="580:1-13233" endpos="584:4-13357" class="code"><div class="cell-content"><codecell class="dir-plugin-disabled lang-js local"><span class="meta"><span class="lang">js</span><span style="color:black;background-color:#dd74b7" class="directive dir-plugin-disabled">plugin-disabled</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=testerror</span></span><pre><code class="js">export const viewer = ({node}) =&gt; {
  throw new Error(&quot;Test Error: Broken Viewer&quot;)
}
</code></pre></codecell></div></cell><cell startpos="586:1-13359" endpos="590:4-13486" class="code"><div class="cell-content"><codecell class="dir-plugin-disabled lang-js local"><span class="meta"><span class="lang">js</span><span style="color:black;background-color:#dd74b7" class="directive dir-plugin-disabled">plugin-disabled</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=syntaxerror</span></span><pre><code class="js">export const viewer = ({node}) =&gt; {
  throw new Error(&quot;Syntax Error: Broken Viewer&quot;
}
</code></pre></codecell></div></cell><cell startpos="591:1-13487" endpos="593:4-13527" class="code output"><div class="cell-content"><codecell class="lang-testerror local output"><span class="meta"><span class="lang">testerror</span></span><output><pre><code class="testerror">Viewer throws an Error
</code></pre></output></codecell></div></cell><cell startpos="595:1-13529" endpos="597:4-13580" class="code output"><div class="cell-content"><codecell class="lang-syntaxerror local output"><span class="meta"><span class="lang">syntaxerror</span></span><output><pre><code class="syntaxerror">TODO: Viewer has a syntax error
</code></pre></output></codecell></div></cell></section></section>
<section id="import" depth="3" class="" startpos="599:1-13582" endpos="609:4-13776"><cell startpos="599:1-13582" endpos="599:11-13592"><div class="cell-content"><h3>Import</h3></div></cell><cell startpos="601:1-13594" endpos="606:4-13734" class="code"><div class="cell-content"><codecell class="dir-plugin-disabled lang-js local"><span class="meta"><span class="lang">js</span><span style="color:black;background-color:#dd74b7" class="directive dir-plugin-disabled">plugin-disabled</span><span class="attribute attr-of" style="color:black;background-color:#00dd70">of=testerror2</span></span><pre><code class="js">throw new Error(&quot;Test Error: Broken Viewer&quot;)
export const viewer = ({node}) =&gt; {
  return &quot;never&quot;
}
</code></pre></codecell></div></cell><cell startpos="607:1-13735" endpos="609:4-13776" class="code output"><div class="cell-content"><codecell class="lang-testerror2 local output"><span class="meta"><span class="lang">testerror2</span></span><output><pre><code class="testerror2">Viewer throws an Error
</code></pre></output></codecell></div></cell></section>
<section id="initial-prototype" depth="2" class="" startpos="611:1-13778" endpos="634:4-14256"><cell startpos="611:1-13778" endpos="611:21-13798"><div class="cell-content"><h2>Initial prototype</h2></div></cell><cell startpos="613:1-13800" endpos="634:4-14256" class="code"><div class="cell-content"><codecell class="dir-below lang-html local"><span class="meta"><span class="lang">html</span><span style="color:white;background-color:#5948c3" class="directive dir-below">below</span><span class="attribute attr-viewer" style="color:black;background-color:#cf5332">viewer=iframe</span></span><pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Test page&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;script type=&quot;module&quot;&gt;

    async function getViewer(src) {
      const module = await import(`data:text/javascript;base64,${ btoa(src)}`);
      return module.viewer;
    }

    getViewer(`export const viewer = () =&gt; &quot;foo!&quot;`).then(viewer =&gt; {
       document.body.innerHTML = (&quot;Got viewer &quot; + !!viewer)
    })

  &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><iframe srcDoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Test page&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;script type=&quot;module&quot;&gt;

    async function getViewer(src) {
      const module = await import(`data:text/javascript;base64,${ btoa(src)}`);
      return module.viewer;
    }

    getViewer(`export const viewer = () =&gt; &quot;foo!&quot;`).then(viewer =&gt; {
       document.body.innerHTML = (&quot;Got viewer &quot; + !!viewer)
    })

  &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
" style="aspect-ratio:1.6"></iframe></codecell></div></cell></section></div></div><div id="backlinks"><h4>Backlinks (5)</h4><ol><li><a title=".lit" href="/index.html">.lit</a></li><li><a title="🎨 Styling &amp; Themes" href="/meta/styling_and_themes.html">🎨 Styling &amp; Themes</a></li><li><a title="🔌 Plugin system" href="/plugin_system.html">🔌 Plugin system</a></li><li><a title="Renderer" href="/renderer/renderer.html">Renderer</a></li><li><a title="🔥 Scratch ⚠️ Pad 🔬" href="/scratch_pad.html">🔥 Scratch ⚠️ Pad 🔬</a></li></ol></div><script src="//cdn.jsdelivr.net/npm/eruda"></script><script>eruda.init();</script><script async="" src="/web.bundle.js"></script></body></html>